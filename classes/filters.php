<?class Filters {var $add_result;//var $red_result;var $list_filters;var $filter_select;function __construct() {	if($_GET['page'] == "add_filter" AND isset($_POST['submit']))	{		$this->add_filter();	}	//elseif($_GET['page'] == "del_category" AND $_GET['id'] != "")	//{	//	$query = mysql_query("DELETE FROM category WHERE id='$_GET[id]'");	//   	header('Location: '.$_SERVER[HTTP_REFERER]);	//}	elseif($_GET['page'] == "catalog" AND $_GET['category'] != "")	{		$this->show_cat_filters($_GET['category']);	}	$this->create_select_filters();}function add_filter(){	if($_POST['title'] == "")	{		$this->add_result = "<script>alert('Вы не ввели название фильтра');</script>";	}	elseif($_POST['eng_title'] == "")	{		$this->add_result = "<script>alert('Вы не ввели транскрипцию фильтра');</script>";	}	else	{		$check_eng_title = mysql_num_rows(mysql_query("SELECT id FROM filter WHERE eng_title='$_POST[eng_title]'"));		if($check_eng_title > 0)		{			$this->add_result = "<script>alert('Вы не ввели уже существующую транскрипцию фильтра');</script>";		}		else		{			$query = mysql_query("INSERT into filter SET title='$_POST[title]', eng_title='$_POST[eng_title]', vision='$_POST[vision]'");			$this_id = mysql_insert_id();			if($query)			{				//echo var_dump($_POST[element_title]);				//echo var_dump($_POST[eng_element_title]);				for($i = 0; $i < count($_POST[element_title]); $i++)				{					if($_POST[element_title][$i] != "" AND $_POST[eng_element_title][$i] != "")					{						mysql_query("INSERT into filter_elements SET title='".$_POST[element_title][$i]."', eng_title='".$_POST[eng_element_title][$i]."', filter='".$this_id."'");						//echo "<p>".$_POST[element_title][$i]." - ".$_POST[eng_element_title][$i]."</p>";					}				}								for($i = 0; $i < count($_POST[category]); $i++)				{					if($_POST[category][$i] != "")					{						mysql_query("INSERT into filter_cats SET filter='$this_id', category='".$_POST[category][$i]."'");						//echo "<p>".$_POST[category][$i]."</p>";					}				}			}		}	}}function show_cat_filters($category){	$category = mysql_fetch_array(mysql_query("SELECT id, parent FROM category WHERE eng_title='$category'"));	if($category[id] != "" AND $category['parent'] != 0)	{		$query = mysql_query("SELECT filter FROM filter_cats WHERE category='$category[id]'");		if(mysql_num_rows($query) > 0)		{			$this->list_filters .="<div class='element'>";			while($array = mysql_fetch_array($query))			{				$filter = mysql_fetch_array(mysql_query("SELECT * FROM filter WHERE id='$array[filter]'"));				$this->list_filters .="<h3>$filter[title]</h3>";				$elements_query = mysql_query("SELECT * FROM filter_elements WHERE filter='$filter[id]'");				while($elements = mysql_fetch_array($elements_query))				{					$this->list_filters .="<p><input type='checkbox' name='$filter[eng_title]' value='$elements[id]'> $elements[title]</p>";				}			}			$this->list_filters .="</div>";		}	}}function create_select_filters($category){	$query = mysql_query("SELECT * FROM filter ORDER by title");	while($array = mysql_fetch_array($query))	{		$this->filter_select .= "<option value='$array[id]'>$array[title]</option>";	}}}